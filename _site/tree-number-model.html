<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tree Numbers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">

    <link href="styles/style.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>
<!--header to hold banner + top navigation area -->
  <div id = "logo-container">   
<a href="http://www.nlm.nih.gov"><img width="430" class="logo" alt="National Library of Medicine" src="images/nih_nlmlogo_webheader.png "></a>
<div class = "meta-nav">
    <a href = "http://id.nlm.nih.gov/mesh/sparql">MeSH SPARQL Endpoint&nbsp;|&nbsp;</a><a href = "about.html">About&nbsp;|&nbsp;</a><a href = "support.html">Support</a>
</div>
</div>



<!-- // end header -->
    <div class="main-container">
      <div class = "left-nav">

<h3>Data Model</h3>
<ul>

  


  
  




<li><a href="/concept-model.html">&raquo;&nbsp;Concepts</a></li>
  
  
  



  

  
  
  




<li><a href="/descriptor-model.html">&raquo;&nbsp;Descriptors</a></li>
  
  
  



  

  
  
  




<li><a href="/entry-combinations-model.html">&raquo;&nbsp;Entry Combinations</a></li>
  
  
  

  



  
  
  



  
  
  




<li><a href="/term-model.html">&raquo;&nbsp;Terms</a></li>
  
  
  



  

  
  
  




<li><a href="/tree-number-model.html">&raquo;&nbsp;Tree Numbers</a></li>
  
  
  
<br/>
</ul>

<h3>REST Interface</h3>
<ul>

  


  
  



  
  
  



  

  
  
  



  
  
  



  

  
  
  



  
  
  

  




<li><a href="/rest-interface.html">&raquo;&nbsp;URL Patterns</a></li>
  
  
  



  
  
  



  
  
  



  

  
  
  



  
  
  
<br/>
</ul>

<h3>Sample Queries</h3>
<ul>

  


  
  



  
  
  



  

  
  
  



  
  
  



  

  
  
  



  
  
  

  



  
  
  




<li><a href="/sample-queries.html">&raquo;&nbsp;Sample Queries</a></li>
  
  
  



  
  
  



  

  
  
  



  
  
  
<br/>
</ul>

</div>
    <h1>MeSH RDF Technical Documentation</h1>
    <div class = "content">
    <img width="35" class="logo" alt="Medical Subject Headings" src="images/meshhead.gif" style = "float:right;margin-right:2px;margin-top:1px;position:relative;top:-2em;"/></a>
    <div class = "breadcrumbs">
    
    <a href = "index.html">Documentation Home</a>&nbsp;&nbsp;&raquo;&nbsp;Tree Numbers
    
    </div>
    <h2>Tree Numbers</h2>
    <br/>
      <p>The following diagram illustrates the problem of tree numbers, that impose multiple overlapping hierarchical<br />
relationships between descriptors. In the diagram, every arrow indicates a skos:broader relationship.</p>

<p>In this particular example, “Eye” belongs to two overlapping trees – one that is depicted in green and <br />
one in purple.</p>

<p>According to the green tree, “Eyebrow” has broader concept “Eye”, which has broader concept “Face”.<br />
According to the purple tree, “Oculomotor Muscles” has broader concept “Eye”, which has broader concept
“Sense Organ”.</p>

<p><img src="https://cloud.githubusercontent.com/assets/77226/3799017/0cfd2b52-1bea-11e4-8786-01e144579e85.png" alt="" /></p>

<p>(This drawing was done in <a href="https://www.lucidchart.com">LucidChart</a>, and is on Google drive <a href="https://drive.google.com/file/d/0B8n-nWqCI5WmbGVxQzJtQmFhSFU/edit?usp=sharing">here</a>.)</p>

<p>Leaving aside the question of whether or not these particular relationships make sense, this is the<br />
way the tree numbers currently exist in MeSH.</p>

<p>The problem comes when you try to use these relations to “walk up the tree”.  If these properties<br />
were transitive, then one could conclude that “Eyebrows” has broader concept “Sense Organ”, or that 
“Oculomotor Muscles” has broader concept “Face”, but neither of those is true according to the MeSH trees.</p>

<p>The way that this is modeled in MeSH RDF is illustrated in the following graph.  Each tree number<br />
is reified as a first-class resource.  <code>skos:broader</code> relations (which are not transitive) are asserted<br />
between the <code>Descriptor</code>s, and <code>skos:broaderTransitive</code> relations (which, obviously, are) are asserted<br />
between the <code>TreeNumber</code>s.</p>

<p><img src="https://cloud.githubusercontent.com/assets/77226/3817027/e4b8db10-1cd3-11e4-9065-d980c79b9e1d.png" alt="" /></p>

<p>(This drawing was done in <a href="https://www.lucidchart.com">LucidChart</a>, and is on Google drive <a href="https://drive.google.com/file/d/0B8n-nWqCI5WmbWx1by1USlRsWDQ/edit?usp=sharing">here</a>.)</p>

<p>With this model, if a user wanted to find all the “broader” ancestors of Eyebrows (D005138) then he or<br />
she could do so, using the SPARQL transitivity operator (“+”), with the following query:</p>

<pre><code class="language-sparql">select ?ancestor
where {
    mesh:D005138 mesh:hasTreeNode ?treeNode .
    ?treeNode skos:broaderTransitive+ ?ancestorTreeNode .
    ?ancestor mesh:hasTreeNode ?ancestorTreeNode
}
</code></pre>

<h2 id="xml">XML</h2>

<pre><code class="language-xml">&lt;DescriptorRecordSet LanguageCode="eng"&gt;
  
  &lt;DescriptorRecord DescriptorClass="1"&gt;
    &lt;DescriptorUI&gt;D005123&lt;/DescriptorUI&gt;
    &lt;DescriptorName&gt;
      &lt;String&gt;Eye&lt;/String&gt;
    &lt;/DescriptorName&gt;
    ...
    &lt;TreeNumberList&gt;
      &lt;TreeNumber&gt;A01.456.505.420&lt;/TreeNumber&gt;
      &lt;TreeNumber&gt;A09.371&lt;/TreeNumber&gt;
    &lt;/TreeNumberList&gt;
    ...
  &lt;/DescriptorRecord&gt;

  &lt;DescriptorRecord DescriptorClass="1"&gt;
    &lt;DescriptorUI&gt;D005145&lt;/DescriptorUI&gt;
    &lt;DescriptorName&gt;
      &lt;String&gt;Face&lt;/String&gt;
    &lt;/DescriptorName&gt;
    ...
    &lt;TreeNumberList&gt;
      &lt;TreeNumber&gt;A01.456.505&lt;/TreeNumber&gt;
    &lt;/TreeNumberList&gt;
    ...
  &lt;/DescriptorRecord&gt;
  
  &lt;DescriptorRecord DescriptorClass="1"&gt;
    &lt;DescriptorUI&gt;D005138&lt;/DescriptorUI&gt;
    &lt;DescriptorName&gt;
      &lt;String&gt;Eyebrows&lt;/String&gt;
    &lt;/DescriptorName&gt;
    ...
    &lt;TreeNumberList&gt;
      &lt;TreeNumber&gt;A01.456.505.420.338&lt;/TreeNumber&gt;
      &lt;TreeNumber&gt;A17.360.296&lt;/TreeNumber&gt;
    &lt;/TreeNumberList&gt;
    ...
  &lt;/DescriptorRecord&gt;
  
  &lt;DescriptorRecord DescriptorClass="1"&gt;
    &lt;DescriptorUI&gt;D009801&lt;/DescriptorUI&gt;
    &lt;DescriptorName&gt;
      &lt;String&gt;Oculomotor Muscles&lt;/String&gt;
    &lt;/DescriptorName&gt;
    ...
    &lt;TreeNumberList&gt;
      &lt;TreeNumber&gt;A02.633.567.700&lt;/TreeNumber&gt;
      &lt;TreeNumber&gt;A09.371.613&lt;/TreeNumber&gt;
    &lt;/TreeNumberList&gt;
    ...
  &lt;/DescriptorRecord&gt;
  
  &lt;DescriptorRecord DescriptorClass="1"&gt;
    &lt;DescriptorUI&gt;D012679&lt;/DescriptorUI&gt;
    &lt;DescriptorName&gt;
      &lt;String&gt;Sense Organs&lt;/String&gt;
    &lt;/DescriptorName&gt;
    ...
    &lt;TreeNumberList&gt;
      &lt;TreeNumber&gt;A09&lt;/TreeNumber&gt;
    &lt;/TreeNumberList&gt;
    ...
  &lt;/DescriptorRecord&gt;

&lt;/DescriptorRecordSet&gt;
</code></pre>

<h2 id="rdf">RDF</h2>

<pre><code>@prefix skos: &lt;http://www.w3.org/2004/02/skos/core#&gt; .
@prefix mesh: &lt;http://id.nlm.nih.gov/mesh/&gt; .
@prefix meshv:  &lt;http://id.nlm.nih.gov/mesh/vocab#&gt; .

# Eye
mesh:D005123 skos:broader mesh:D005145, mesh:D012679 ;
             meshv:treeNumber mesh:A09.371 ,
                              mesh:A01.456.505.420 .

# Eyebrows
mesh:D005138 skos:broader mesh:D005123 ;
             meshv:treeNumber mesh:A01.456.505.420.338 .

# Face
mesh:D005145 meshv:treeNumber mesh:A01.456.505 .

# Oculomotor Muscles
mesh:D009801 skos:broader mesh:D005123 ;
             meshv:treeNumber mesh:A09.371.613 .

# Sense Organs
mesh:D012679 meshv:treeNumber  mesh:A09 .

# Relations among TreeNumbers
mesh:A01.456.505.420  skos:broaderTransitive  mesh:A01.456.505 .
mesh:A09.371  skos:broaderTransitive  mesh:A09 .
mesh:A01.456.505.420.338  skos:broaderTransitive  mesh:A01.456.505.420 .
mesh:A09.371.613  skos:broaderTransitive  mesh:A09.371 .
</code></pre>

<h2 id="generating-the-rdf">Generating the RDF</h2>

<p>The following SPARQL query creates a table that shows the relationships between “Eye”<br />
and each of the immediate broader and narrower concepts for each of its tree numbers:</p>

<pre><code class="language-sparql">PREFIX mesh: &lt;http://id.nlm.nih.gov/mesh/&gt;
PREFIX meshv: &lt;http://id.nlm.nih.gov/mesh/vocab#&gt;

SELECT *
from &lt;http://chrismaloney.org/mesh&gt;
where {
  mesh:D005123 meshv:treeNumber ?tree_number .

  {
    select ?tree_number 
           ?broader_tree_number ?broader_descriptor 
           ?narrower_tree_number ?narrower_descriptor
    where {
      ?tree_number skos:broaderTransitive ?broader_tree_number .
      ?broader_descriptor meshv:treeNumber ?broader_tree_number .
      mesh:D005123 skos:broader ?broader_descriptor .

      ?narrower_tree_number skos:broaderTransitive ?tree_number .
      ?narrower_descriptor meshv:treeNumber ?narrower_tree_number .
      ?narrower_descriptor skos:broader mesh:D005123 .
    }
  }
}
</code></pre>

<p>The next SPARQL query is very similar, but outputs RDF (using the CONSTRUCT clause) and<br />
reconstructs the graph that is shown in the figure above.  To execute this on the current<br />
Virtuoso test bed, click 
<a href="http://jatspan.org:8890/sparql?query=PREFIX%20mesh%3A%20%3Chttp%3A%2F%2Fid.nlm.nih.gov%2Fmesh%2F%3E%0APREFIX%20meshv%3A%20%3Chttp%3A%2F%2Fid.nlm.nih.gov%2Fmesh%2Fvocab%23%3E%0A%0ACONSTRUCT%20%7B%0A%20%20mesh%3AD005123%20meshv%3AtreeNumber%20%3Ftree_number%20.%0A%20%20%3Ftree_number%20skos%3AbroaderTransitive%20%3Fbroader_tree_number%20.%0A%20%20%3Fbroader_descriptor%20meshv%3AtreeNumber%20%3Fbroader_tree_number%20.%0A%20%20mesh%3AD005123%20skos%3Abroader%20%3Fbroader_descriptor%20.%0A%0A%20%20%3Fnarrower_tree_number%20skos%3AbroaderTransitive%20%3Ftree_number%20.%0A%20%20%3Fnarrower_descriptor%20meshv%3AtreeNumber%20%3Fnarrower_tree_number%20.%0A%20%20%3Fnarrower_descriptor%20skos%3Abroader%20mesh%3AD005123%20.%0A%7D%0Afrom%20%3Chttp%3A%2F%2Fchrismaloney.org%2Fmesh%3E%0Awhere%20%7B%0A%20%20mesh%3AD005123%20meshv%3AtreeNumber%20%3Ftree_number%20.%0A%0A%20%20%7B%0A%20%20%20%20select%20%3Ftree_number%20%0A%20%20%20%20%20%20%20%20%20%20%20%3Fbroader_tree_number%20%3Fbroader_descriptor%20%0A%20%20%20%20%20%20%20%20%20%20%20%3Fnarrower_tree_number%20%3Fnarrower_descriptor%0A%20%20%20%20where%20%7B%0A%20%20%20%20%20%20%3Ftree_number%20skos%3AbroaderTransitive%20%3Fbroader_tree_number%20.%0A%20%20%20%20%20%20%3Fbroader_descriptor%20meshv%3AtreeNumber%20%3Fbroader_tree_number%20.%0A%20%20%20%20%20%20mesh%3AD005123%20skos%3Abroader%20%3Fbroader_descriptor%20.%0A%0A%20%20%20%20%20%20%3Fnarrower_tree_number%20skos%3AbroaderTransitive%20%3Ftree_number%20.%0A%20%20%20%20%20%20%3Fnarrower_descriptor%20meshv%3AtreeNumber%20%3Fnarrower_tree_number%20.%0A%20%20%20%20%20%20%3Fnarrower_descriptor%20skos%3Abroader%20mesh%3AD005123%20.%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D&amp;format=TURTLE">here</a></p>

<pre><code class="language-sparql">PREFIX mesh: &lt;http://id.nlm.nih.gov/mesh/&gt;
PREFIX meshv: &lt;http://id.nlm.nih.gov/mesh/vocab#&gt;

CONSTRUCT {
  mesh:D005123 meshv:treeNumber ?tree_number .
  ?tree_number skos:broaderTransitive ?broader_tree_number .
  ?broader_descriptor meshv:treeNumber ?broader_tree_number .
  mesh:D005123 skos:broader ?broader_descriptor .

  ?narrower_tree_number skos:broaderTransitive ?tree_number .
  ?narrower_descriptor meshv:treeNumber ?narrower_tree_number .
  ?narrower_descriptor skos:broader mesh:D005123 .
}
from &lt;http://chrismaloney.org/mesh&gt;
where {
  mesh:D005123 meshv:treeNumber ?tree_number .

  {
    select ?tree_number 
           ?broader_tree_number ?broader_descriptor 
           ?narrower_tree_number ?narrower_descriptor
    where {
      ?tree_number skos:broaderTransitive ?broader_tree_number .
      ?broader_descriptor meshv:treeNumber ?broader_tree_number .
      mesh:D005123 skos:broader ?broader_descriptor .

      ?narrower_tree_number skos:broaderTransitive ?tree_number .
      ?narrower_descriptor meshv:treeNumber ?narrower_tree_number .
      ?narrower_descriptor skos:broader mesh:D005123 .
    }
  }
}
</code></pre>

    </div>
      
    </div>

<!-- footer area   -->
 <div id = "footer">
  Page first published: 01 Nov 2014<br/>
  Page last updated: 17 Oct 2014
</div>
 <!-- //end footer -->
  </body>
</html>